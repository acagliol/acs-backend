{
  "environment": "dev",
  "project_id": "terraform-anay-dev",
  "region": "us-central1",
  "zone": "us-central1-c",
  
  "firestore": {
    "database_id": "(default)",
    "location_id": "us-central1",
    "database_type": "FIRESTORE_NATIVE",
    "collections": {
      "users": {
        "name": "users",
        "fields": {
          "email": { "type": "string" },
          "name": { "type": "string" },
          "created_at": { "type": "timestamp" }
        }
      },
      "emails": {
        "name": "emails",
        "fields": {
          "from": { "type": "string" },
          "to": { "type": "string" },
          "subject": { "type": "string" },
          "received_at": { "type": "timestamp" }
        }
      }
    }
  },
  
  "cloud_functions": {
    "region": "us-central1",
    "functions": {
      "email_processor": {
        "name": "email-processor",
        "description": "Process incoming emails from SES/SQS",
        "runtime": "nodejs18",
        "entry_point": "processEmail",
        "source_dir": "../functions/email-processor",
        "trigger_type": "pubsub",
        "trigger_config": {
          "event_type": "google.pubsub.topic.publish",
          "attribute": "topic",
          "value": "email-queue-dev"
        },
        "environment_variables": {
          "ENVIRONMENT": "dev",
          "FIRESTORE_COLLECTION": "emails"
        },
        "memory_mb": 512,
        "timeout_seconds": 300
      },
      "user_api": {
        "name": "user-api",
        "description": "User management API",
        "runtime": "nodejs18",
        "entry_point": "handleRequest",
        "source_dir": "../functions/user-api",
        "trigger_type": "http",
        "environment_variables": {
          "ENVIRONMENT": "dev",
          "FIRESTORE_COLLECTION": "users"
        },
        "memory_mb": 256,
        "timeout_seconds": 60
      }
    }
  },
  
  "api_gateway": {
    "region": "us-central1",
    "api_config": {
      "api_id": "company-api",
      "display_name": "Company API",
      "description": "Main API for company services",
      "endpoints": {
        "get_users": {
          "name": "Get Users",
          "path": "/users",
          "method": "GET",
          "function_name": "user-api",
          "function_region": "us-central1",
          "auth_required": true,
          "cors_enabled": true
        },
        "create_user": {
          "name": "Create User",
          "path": "/users",
          "method": "POST",
          "function_name": "user-api",
          "function_region": "us-central1",
          "auth_required": true,
          "cors_enabled": true
        }
      }
    }
  },
  
  "cloud_storage": {
    "region": "us-central1",
    "buckets": {
      "email_attachments": {
        "name": "email-attachments",
        "location": "US",
        "storage_class": "STANDARD",
        "versioning": true,
        "lifecycle_rules": [
          {
            "action": {
              "type": "Delete"
            },
            "condition": {
              "age": 365
            }
          }
        ],
        "cors": [
          {
            "origin": ["*"],
            "method": ["GET", "POST", "PUT", "DELETE"],
            "response_header": ["Content-Type", "Authorization"],
            "max_age_seconds": 3600
          }
        ]
      },
      "processed_emails": {
        "name": "processed-emails",
        "location": "US",
        "storage_class": "STANDARD",
        "versioning": false
      }
    }
  },
  
  "pub_sub": {
    "region": "us-central1",
    "topics": {
      "email_queue": {
        "name": "email-queue",
        "message_retention_duration": "604800s"
      },
      "email_processed": {
        "name": "email-processed",
        "message_retention_duration": "604800s"
      }
    },
    "subscriptions": {
      "email_processor_sub": {
        "name": "email-processor-sub",
        "topic": "email_queue",
        "ack_deadline_seconds": 60,
        "retry_policy": {
          "minimum_backoff": "10s",
          "maximum_backoff": "600s"
        }
      }
    }
  },
  
  "identity_platform": {
    "region": "us-central1",
    "identity_platform_config": {
      "display_name": "Company Auth",
      "support_email": "support@company.com",
      "authorized_domains": ["company.com"],
      "sign_in_options": [
        {
          "provider": "email",
          "enabled": true,
          "display_name": "Email/Password"
        },
        {
          "provider": "google",
          "enabled": true,
          "display_name": "Google",
          "provider_config": {
            "client_id": "your-google-client-id",
            "client_secret": "your-google-client-secret",
            "issuer": "https://accounts.google.com"
          }
        }
      ],
      "password_policy": {
        "min_password_length": 8,
        "max_password_length": 100,
        "allow_numeric_characters": true,
        "allow_uppercase_characters": true,
        "allow_lowercase_characters": true,
        "allow_special_characters": true
      },
      "email_config": {
        "enabled": true,
        "require_email_verification": true,
        "allow_duplicate_emails": false
      }
    }
  },
  
  "cloud_kms": {
    "region": "us-central1",
    "keyrings": {
      "app_keys": {
        "name": "app-keys",
        "description": "Application encryption keys",
        "keys": {
          "data_encryption": {
            "name": "data-encryption",
            "purpose": "ENCRYPT_DECRYPT",
            "algorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
            "protection_level": "SOFTWARE",
            "rotation_period": "7776000s"
          }
        }
      }
    }
  },
  
  "monitoring": {
    "region": "us-central1",
    "monitoring_config": {
      "enable_logging": true,
      "enable_monitoring": true,
      "log_sinks": {
        "audit_logs": {
          "name": "audit-logs",
          "destination": "storage.googleapis.com/audit-logs-bucket-dev",
          "filter": "resource.type=\"cloud_function\""
        }
      },
      "uptime_checks": {
        "api_health": {
          "display_name": "API Health Check",
          "timeout": "10s",
          "period": "60s",
          "http_check": {
            "path": "/health",
            "port": 443,
            "use_ssl": true,
            "validate_ssl": true
          }
        }
      },
      "alerting_policies": {
        "high_error_rate": {
          "display_name": "High Error Rate",
          "combiner": "OR",
          "conditions": [
            {
              "display_name": "Error Rate > 5%",
              "condition_threshold": {
                "filter": "metric.type=\"cloudfunctions.googleapis.com/function/execution_count\" AND resource.type=\"cloud_function\"",
                "duration": "300s",
                "comparison": "COMPARISON_GREATER_THAN",
                "threshold_value": 0.05,
                "aggregations": [
                  {
                    "alignment_period": "60s",
                    "per_series_aligner": "ALIGN_RATE",
                    "cross_series_reducer": "REDUCE_MEAN"
                  }
                ]
              }
            }
          ]
        }
      }
    }
  }
} 